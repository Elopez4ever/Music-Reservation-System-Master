<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.bookingsystem.mapper.SystemConfigMapper">

    <!-- 查询所有系统配置，返回Map，键为system_name，值为description -->
    <select id="getAllConfigsAsMap" resultType="java.util.HashMap">
        SELECT
            system_name as `key`,
            description as `value`
        FROM
            system_config
    </select>

    <insert id="add">
        INSERT INTO system_config (system_name, description, created_at, updated_at)
        VALUES (#{systemName}, #{description}, NOW(), NOW())
    </insert>
    <!-- 获取系统配置 -->
    <select id="getSystemConfig" resultType="com.bookingsystem.pojo.SystemConfig">
        SELECT id, system_name, logo_url, description, admin_email, contact_phone, created_at, updated_at
        FROM system_config
        LIMIT 1
    </select>
    <select id="selectAllSystemConfig" resultType="com.bookingsystem.pojo.SystemConfig">
        SELECT id, system_name, logo_url, description, admin_email, contact_phone, created_at, updated_at
        FROM system_config
    </select>
    <select id="selectAllSystemConfigNames" resultType="java.lang.String">
        SELECT system_name
        FROM system_config
    </select>

    <!-- 更新系统配置 -->
    <update id="updateSystemConfig">
        UPDATE system_config
        SET
            description = #{description},
            updated_at = #{updatedAt}
        WHERE system_name = #{systemName}
    </update>
</mapper>